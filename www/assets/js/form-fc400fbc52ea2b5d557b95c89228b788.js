/*
 Copyright (c) 2008 Yii Software LLC
 @license http://www.yiiframework.com/license/
 @author Qiang Xue <qiang.xue@gmail.com>
 @since 2.0
*/
var $jscomp={scope:{},findInternal:function(c,l,g){c instanceof String&&(c=String(c));for(var h=c.length,k=0;k<h;k++){var m=c[k];if(l.call(g,m,k,c))return{i:k,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(c,l,g){if(g.get||g.set)throw new TypeError("ES3 does not support getters and setters.");c!=Array.prototype&&c!=Object.prototype&&(c[l]=g.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,l,g,h){if(l){g=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var k=c[h];k in g||(g[k]={});g=g[k]}c=c[c.length-1];h=g[c];l=l(h);l!=h&&null!=l&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,g){return $jscomp.findInternal(this,c,g).v}},"es6-impl","es3");
(function(c){c.fn.yiiActiveForm=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof a&&a?(c.error("Method "+a+" does not exist on jQuery.yiiActiveForm"),!1):m.init.apply(this,arguments)};var l={encodeErrorSummary:!0,errorSummary:".error-summary",validateOnSubmit:!0,errorCssClass:"has-error",successCssClass:"has-success",validatingCssClass:"validating",ajaxParam:"ajax",ajaxDataType:"json",validationUrl:void 0,scrollToError:!0},g={id:void 0,name:void 0,
container:void 0,input:void 0,error:".help-block",encodeError:!0,validateOnChange:!0,validateOnBlur:!0,validateOnType:!1,validationDelay:500,enableAjaxValidation:!1,validate:void 0,status:0,cancelled:!1,value:void 0},h,k=function(a){h&&(h.resolve(),h=void 0,a.removeData("yiiSubmitFinalizePromise"))},m={init:function(a,b){return this.each(function(){var d=c(this);if(!d.data("yiiActiveForm")){var e=c.extend({},l,b||{});void 0===e.validationUrl&&(e.validationUrl=d.attr("action"));c.each(a,function(b){a[b]=
c.extend({value:n(d,this)},g,this);u(d,a[b])});d.data("yiiActiveForm",{settings:e,attributes:a,submitting:!1,validated:!1,target:d.attr("target")});d.bind("reset.yiiActiveForm",m.resetForm);e.validateOnSubmit&&(d.on("mouseup.yiiActiveForm keyup.yiiActiveForm",":submit",function(){d.data("yiiActiveForm").submitObject=c(this)}),d.on("submit.yiiActiveForm",m.submitForm))}})},add:function(a){var b=c(this);a=c.extend({value:n(b,a)},g,a);b.data("yiiActiveForm").attributes.push(a);u(b,a)},remove:function(a){var b=
c(this),d=b.data("yiiActiveForm").attributes,e=-1,f=void 0;c.each(d,function(b){if(d[b].id==a)return e=b,f=d[b],!1});0<=e&&(d.splice(e,1),p(b,f).off(".yiiActiveForm"));return f},validateAttribute:function(a){a=m.find.call(this,a);void 0!=a&&q(c(this),a,!0)},find:function(a){var b=c(this).data("yiiActiveForm").attributes,d=void 0;c.each(b,function(c){if(b[c].id==a)return d=b[c],!1});return d},destroy:function(){return this.each(function(){c(this).unbind(".yiiActiveForm");c(this).removeData("yiiActiveForm")})},
data:function(){return this.data("yiiActiveForm")},validate:function(){var a=c(this),b=a.data("yiiActiveForm"),d=!1,e={},f=w(),g=b.submitting,h=c.Event("beforeValidate");a.trigger(h,[e,f]);g&&!1===h.result?(b.submitting=!1,k(a)):(c.each(b.attributes,function(){if(!c(this.input).is(":disabled")&&(this.cancelled=!1,b.submitting||2===this.status||3===this.status)){var g=e[this.id];void 0===g&&(g=[],e[this.id]=g);var h=c.Event("beforeValidateAttribute");a.trigger(h,[this,g,f]);!1!==h.result?(this.validate&&
this.validate(this,n(a,this),g,f,a),this.enableAjaxValidation&&(d=!0)):this.cancelled=!0}}),c.when.apply(this,f).always(function(){for(var f in e)0===e[f].length&&delete e[f];if(c.isEmptyObject(e)&&d){f=b.submitObject;var h="&"+b.settings.ajaxParam+"="+a.attr("id");f&&f.length&&f.attr("name")&&(h+="&"+f.attr("name")+"="+f.attr("value"));c.ajax({url:b.settings.validationUrl,type:a.attr("method"),data:a.serialize()+h,dataType:b.settings.ajaxDataType,complete:function(b,c){a.trigger("ajaxComplete",[b,
c])},beforeSend:function(b,c){a.trigger("ajaxBeforeSend",[b,c])},success:function(d){null!==d&&"object"===typeof d?(c.each(b.attributes,function(){this.enableAjaxValidation&&!this.cancelled||delete d[this.id]}),r(a,c.extend(e,d),g)):r(a,e,g)},error:function(){b.submitting=!1;k(a)}})}else b.submitting?setTimeout(function(){r(a,e,g)},200):r(a,e,g)}))},submitForm:function(){var a=c(this),b=a.data("yiiActiveForm");if(b.validated){b.submitting=!1;var d=c.Event("beforeSubmit");a.trigger(d);if(!1===d.result)return b.validated=
!1,k(a),!1;b=a.data("yiiActiveForm").submitObject||a.find(":submit:first");b.length&&"submit"==b.attr("type")&&b.attr("name")&&(d=c('input[type="hidden"][name="'+b.attr("name")+'"]',a),d.length?d.attr("value",b.attr("value")):c("<input>").attr({type:"hidden",name:b.attr("name"),value:b.attr("value")}).appendTo(a));return!0}h=c.Deferred();a.data("yiiSubmitFinalizePromise",h.promise());void 0!==b.settings.timer&&clearTimeout(b.settings.timer);b.submitting=!0;m.validate.call(a);return!1},resetForm:function(){var a=
c(this),b=a.data("yiiActiveForm");setTimeout(function(){c.each(b.attributes,function(){this.value=n(a,this);this.status=0;var c=a.find(this.container);c.removeClass(b.settings.validatingCssClass+" "+b.settings.errorCssClass+" "+b.settings.successCssClass);c.find(this.error).html("")});a.find(b.settings.errorSummary).hide().find("ul").html("")},1)},updateMessages:function(a,b){var d=c(this),e=d.data("yiiActiveForm");c.each(e.attributes,function(){t(d,this,a)});b&&v(d,a)},updateAttribute:function(a,
b){var d=m.find.call(this,a);if(void 0!=d){var e={};e[a]=b;t(c(this),d,e)}}},u=function(a,b){var d=p(a,b);if(b.validateOnChange)d.on("change.yiiActiveForm",function(){q(a,b,!1)});if(b.validateOnBlur)d.on("blur.yiiActiveForm",function(){0!=b.status&&1!=b.status||q(a,b,!0)});if(b.validateOnType)d.on("keyup.yiiActiveForm",function(d){-1===c.inArray(d.which,[16,17,18,37,38,39,40])&&b.value!==n(a,b)&&q(a,b,!1,b.validationDelay)})},q=function(a,b,d,e){var f=a.data("yiiActiveForm");d&&(b.status=2);c.each(f.attributes,
function(){this.value!==n(a,this)&&(this.status=2,d=!0)});d&&(void 0!==f.settings.timer&&clearTimeout(f.settings.timer),f.settings.timer=setTimeout(function(){f.submitting||a.is(":hidden")||(c.each(f.attributes,function(){2===this.status&&(this.status=3,a.find(this.container).addClass(f.settings.validatingCssClass))}),m.validate.call(a))},e?e:200))},w=function(){var a=[];a.add=function(b){this.push(new c.Deferred(b))};return a},r=function(a,b,d){var e=a.data("yiiActiveForm");if(d){var f=[];c.each(e.attributes,
function(){c(this.input).is(":disabled")||this.cancelled||!t(a,this,b)||f.push(this)});a.trigger("afterValidate",[b,f]);v(a,b);if(f.length){if(e.settings.scrollToError){d=a.find(c.map(f,function(b){return b.input}).join(",")).first().closest(":visible").offset().top;var g=c(window).scrollTop();(d<g||d>g+c(window).height())&&c(window).scrollTop(d)}e.submitting=!1}else e.validated=!0,(d=e.submitObject?e.submitObject.attr("formtarget"):null)&&a.attr("target",d),a.submit(),a.attr("target",e.target)}else c.each(e.attributes,
function(){this.cancelled||2!==this.status&&3!==this.status||t(a,this,b)});k(a)},t=function(a,b,d){var e=a.data("yiiActiveForm"),f=p(a,b),g=!1;c.isArray(d[b.id])||(d[b.id]=[]);a.trigger("afterValidateAttribute",[b,d[b.id]]);b.status=1;if(f.length){var g=0<d[b.id].length,f=a.find(b.container),h=f.find(b.error);g?(b.encodeError?h.text(d[b.id][0]):h.html(d[b.id][0]),f.removeClass(e.settings.validatingCssClass+" "+e.settings.successCssClass).addClass(e.settings.errorCssClass)):(h.empty(),f.removeClass(e.settings.validatingCssClass+
" "+e.settings.errorCssClass+" ").addClass(e.settings.successCssClass));b.value=n(a,b)}return g},v=function(a,b){var d=a.data("yiiActiveForm"),e=a.find(d.settings.errorSummary),f=e.find("ul").empty();e.length&&b&&(c.each(d.attributes,function(){if(c.isArray(b[this.id])&&b[this.id].length){var a=c("<li/>");d.settings.encodeErrorSummary?a.text(b[this.id][0]):a.html(b[this.id][0]);f.append(a)}}),e.toggle(0<f.find("li").length))},n=function(a,b){var c=p(a,b),e=c.attr("type");return"checkbox"===e||"radio"===
e?(e=c.filter(":checked"),e.length||(e=a.find('input[type=hidden][name="'+c.attr("name")+'"]')),e.val()):c.val()},p=function(a,b){var c=a.find(b.input);return c.length&&"div"===c[0].tagName.toLowerCase()?c.find("input"):c}})(window.jQuery);
